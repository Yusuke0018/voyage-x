# 設計上の意思決定記録

## 1. ローカルファーストアーキテクチャ
**決定**: SQL.js + localforageでブラウザ内データ保存

**理由**:
- プライバシー保護（データが外部に送信されない）
- オフライン対応が容易
- サーバーコスト不要
- 個人利用を想定したシンプルな構成

**代替案**:
- Firebase/Supabase：クラウド同期は便利だが、プライバシー懸念とコスト
- IndexedDB直接：SQLiteの方がSQLで操作しやすい

## 2. useDatabase フックによるデータ操作統一
**決定**: すべてのデータ操作を単一のカスタムフックで管理

**理由**:
- 一貫性のあるAPIインターフェース
- エラーハンドリングの一元化
- テストが容易
- 後からバックエンド追加が簡単

## 3. OpenAI APIキーのlocalStorage保存
**決定**: APIキーを環境変数ではなくlocalStorageに保存

**理由**:
- ユーザーが自分のAPIキーを使用
- ビルド時にキーが公開されない
- 設定画面から簡単に変更可能

**セキュリティ懸念**:
- XSS攻撃のリスクがあるが、個人利用前提なので許容

## 4. 航海メタファーの採用
**決定**: 目標管理に「宝島」「島々」「羅針盤」等のメタファー使用

**理由**:
- 直感的で理解しやすい
- モチベーション向上
- 他のタスク管理アプリとの差別化
- 感情要素も「天候」として統一

## 5. Next.js App Router の使用
**決定**: Next.js 15のApp Routerを採用

**理由**:
- React Server Componentsの活用（将来的に）
- ファイルベースのルーティング
- 最新のReact機能に対応
- Vercelデプロイが簡単

## 6. shadcn/ui コンポーネントライブラリ
**決定**: UIコンポーネントにshadcn/uiを採用

**理由**:
- カスタマイズが容易
- Tailwind CSSとの親和性
- コピー＆ペーストで完全な所有権
- バンドルサイズが小さい

## 7. PWA化の実装
**決定**: Service Workerとmanifest.jsonでPWA化

**理由**:
- アプリストアなしで配布可能
- オフライン対応
- ネイティブアプリライクなUX
- ホーム画面追加が可能

## 8. タスク優先度の3段階設定
**決定**: high/medium/lowの3段階のみ

**理由**:
- シンプルで意思決定が早い
- 多すぎると選ぶのが難しい
- 色分けで視覚的に区別可能

## 次の検討事項
1. **データ同期**: クラウドバックアップの必要性
2. **パフォーマンス**: 大量データ時の対応
3. **セキュリティ**: APIキーのより安全な管理方法
4. **モバイルアプリ**: React Nativeでのネイティブ化