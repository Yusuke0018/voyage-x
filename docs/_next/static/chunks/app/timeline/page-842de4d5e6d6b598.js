(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[404],{814:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(1847).A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},2685:(e,t,a)=>{"use strict";a.d(t,{t:()=>o});var r=a(2115);class s{getData(){let e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}saveData(e){localStorage.setItem(this.storageKey,JSON.stringify(e))}async query(e,t){let a=this.getData()[e]||[];return t?a.filter(t):a}async insert(e,t){let a=this.getData();a[e]||(a[e]=[]);let r="".concat(e,"_").concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),s={...t,id:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return a[e].push(s),this.saveData(a),r}async update(e,t,a){let r=this.getData();if(!r[e])return;let s=r[e].findIndex(e=>e.id===t);-1!==s&&(r[e][s]={...r[e][s],...a,updatedAt:new Date().toISOString()},this.saveData(r))}async delete(e,t){let a=this.getData();a[e]&&(a[e]=a[e].filter(e=>e.id!==t),this.saveData(a))}constructor(){this.storageKey="voyage-data"}}let n=null;async function l(){return n||(n=new s)}async function i(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=await l(),a=e.match(/SELECT .* FROM ([a-zA-Z_]+)/i);if(a){let e=a[1];return t.query(e)}return[]}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=await l(),r=e.match(/INSERT INTO ([a-zA-Z_]+) \((.*?)\) VALUES/i);if(r){let e=r[1],s=r[2].split(",").map(e=>e.trim()),n={};return s.forEach((e,a)=>{n[e]=t[a]}),a.insert(e,n)}throw Error("Unsupported SQL operation")}function o(){let[e,t]=(0,r.useState)(!1),[a,s]=(0,r.useState)(null);(0,r.useEffect)(()=>{l().then(()=>t(!0)).catch(e=>s(e.message))},[]);let n=(0,r.useCallback)(async e=>{let t=crypto.randomUUID(),a=new Date().toISOString();return await d("INSERT INTO goals (id, title, description, target_date, vision, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",[t,e.title,e.description,e.targetDate.toISOString(),e.vision||null,a,a]),t},[]),o=(0,r.useCallback)(async()=>(await i("SELECT * FROM goals ORDER BY created_at DESC")).map(e=>({id:e.id,title:e.title,description:e.description,targetDate:new Date(e.target_date),vision:e.vision,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)})),[]),c=(0,r.useCallback)(async(e,t)=>{let a=[],r=[];void 0!==t.title&&(a.push("title = ?"),r.push(t.title)),void 0!==t.description&&(a.push("description = ?"),r.push(t.description)),void 0!==t.targetDate&&(a.push("target_date = ?"),r.push(t.targetDate.toISOString())),void 0!==t.vision&&(a.push("vision = ?"),r.push(t.vision)),a.push("updated_at = ?"),r.push(new Date().toISOString()),r.push(e),await i("UPDATE goals SET ".concat(a.join(", ")," WHERE id = ?"),r)},[]),u=(0,r.useCallback)(async e=>{await i("DELETE FROM goals WHERE id = ?",[e])},[]),m=(0,r.useCallback)(async e=>{let t=crypto.randomUUID(),a=new Date().toISOString();return await d("INSERT INTO milestones (id, goal_id, title, description, target_date, completed, order_num, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)",[t,e.goalId,e.title,e.description||null,e.targetDate.toISOString(),+!!e.completed,e.order,a,a]),t},[]),p=(0,r.useCallback)(async e=>(await i("SELECT * FROM milestones WHERE goal_id = ? ORDER BY order_num ASC",[e])).map(e=>({id:e.id,goalId:e.goal_id,title:e.title,description:e.description,targetDate:new Date(e.target_date),completed:1===e.completed,order:e.order_num,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)})),[]),g=(0,r.useCallback)(async e=>{var t,a;let r=crypto.randomUUID(),s=new Date().toISOString();return await d("INSERT INTO tasks (id, milestone_id, title, description, status, priority, due_date, completed_at, dependencies, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",[r,e.milestoneId,e.title,e.description||null,e.status,e.priority,(null==(t=e.dueDate)?void 0:t.toISOString())||null,(null==(a=e.completedAt)?void 0:a.toISOString())||null,e.dependencies?JSON.stringify(e.dependencies):null,s,s]),r},[]),h=(0,r.useCallback)(async e=>(await i("SELECT * FROM tasks WHERE milestone_id = ? ORDER BY priority DESC, created_at ASC",[e])).map(e=>({id:e.id,milestoneId:e.milestone_id,title:e.title,description:e.description,status:e.status,priority:e.priority,dueDate:e.due_date?new Date(e.due_date):void 0,completedAt:e.completed_at?new Date(e.completed_at):void 0,dependencies:e.dependencies?JSON.parse(e.dependencies):void 0,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)})),[]),x=(0,r.useCallback)(async(e,t)=>{let a=new Date().toISOString(),r="done"===t?a:null;await i("UPDATE tasks SET status = ?, completed_at = ?, updated_at = ? WHERE id = ?",[t,r,a,e])},[]);return{isReady:e,error:a,createGoal:n,getGoals:o,updateGoal:c,deleteGoal:u,createMilestone:m,getMilestonesByGoal:p,createTask:g,getTasksByMilestone:h,updateTaskStatus:x,saveEmotionLog:(0,r.useCallback)(async e=>{crypto.randomUUID();let t=new Date().toISOString(),a=e.date.toISOString().split("T")[0];await i("INSERT OR REPLACE INTO emotion_logs (id, date, mood, energy, note, created_at) VALUES ((SELECT id FROM emotion_logs WHERE date = ?), ?, ?, ?, ?, ?)",[a,a,e.mood,e.energy,e.note||null,t])},[]),getEmotionLogs:(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return(await i("SELECT * FROM emotion_logs ORDER BY date DESC LIMIT ?",[e])).map(e=>({id:e.id,date:new Date(e.date),mood:e.mood,energy:e.energy,note:e.note,createdAt:new Date(e.created_at)}))},[])}}},3193:(e,t,a)=>{Promise.resolve().then(a.bind(a,9977))},3209:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>i,Zp:()=>n,aR:()=>l});var r=a(5155);a(2115);var s=a(5016);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",t),...a})}function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",t),...a})}},3414:(e,t,a)=>{"use strict";a.d(t,{k:()=>w});var r=a(5155),s=a(2115),n=a(3468),l=a(7602),i="Progress",[d,o]=(0,n.A)(i),[c,u]=d(i),m=s.forwardRef((e,t)=>{var a,s,n,i;let{__scopeProgress:d,value:o=null,max:u,getValueLabel:m=h,...p}=e;(u||0===u)&&!v(u)&&console.error((a="".concat(u),s="Progress","Invalid prop `max` of value `".concat(a,"` supplied to `").concat(s,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let g=v(u)?u:100;null===o||y(o,g)||console.error((n="".concat(o),i="Progress","Invalid prop `value` of value `".concat(n,"` supplied to `").concat(i,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let N=y(o,g)?o:null,w=f(N)?m(N,g):void 0;return(0,r.jsx)(c,{scope:d,value:N,max:g,children:(0,r.jsx)(l.sG.div,{"aria-valuemax":g,"aria-valuemin":0,"aria-valuenow":f(N)?N:void 0,"aria-valuetext":w,role:"progressbar","data-state":x(N,g),"data-value":null!=N?N:void 0,"data-max":g,...p,ref:t})})});m.displayName=i;var p="ProgressIndicator",g=s.forwardRef((e,t)=>{var a;let{__scopeProgress:s,...n}=e,i=u(p,s);return(0,r.jsx)(l.sG.div,{"data-state":x(i.value,i.max),"data-value":null!=(a=i.value)?a:void 0,"data-max":i.max,...n,ref:t})});function h(e,t){return"".concat(Math.round(e/t*100),"%")}function x(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function f(e){return"number"==typeof e}function v(e){return f(e)&&!isNaN(e)&&e>0}function y(e,t){return f(e)&&!isNaN(e)&&e<=t&&e>=0}g.displayName=p;var N=a(5016);function w(e){let{className:t,value:a,...s}=e;return(0,r.jsx)(m,{"data-slot":"progress",className:(0,N.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...s,children:(0,r.jsx)(g,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})}},3468:(e,t,a)=>{"use strict";a.d(t,{A:()=>l,q:()=>n});var r=a(2115),s=a(5155);function n(e,t){let a=r.createContext(t),n=e=>{let{children:t,...n}=e,l=r.useMemo(()=>n,Object.values(n));return(0,s.jsx)(a.Provider,{value:l,children:t})};return n.displayName=e+"Provider",[n,function(s){let n=r.useContext(a);if(n)return n;if(void 0!==t)return t;throw Error(`\`${s}\` must be used within \`${e}\``)}]}function l(e,t=[]){let a=[],n=()=>{let t=a.map(e=>r.createContext(e));return function(a){let s=a?.[e]||t;return r.useMemo(()=>({[`__scope${e}`]:{...a,[e]:s}}),[a,s])}};return n.scopeName=e,[function(t,n){let l=r.createContext(n),i=a.length;a=[...a,n];let d=t=>{let{scope:a,children:n,...d}=t,o=a?.[e]?.[i]||l,c=r.useMemo(()=>d,Object.values(d));return(0,s.jsx)(o.Provider,{value:c,children:n})};return d.displayName=t+"Provider",[d,function(a,s){let d=s?.[e]?.[i]||l,o=r.useContext(d);if(o)return o;if(void 0!==n)return n;throw Error(`\`${a}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let a=()=>{let a=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=a.reduce((t,{useScope:a,scopeName:r})=>{let s=a(e)[`__scope${r}`];return{...t,...s}},{});return r.useMemo(()=>({[`__scope${t.scopeName}`]:s}),[s])}};return a.scopeName=t.scopeName,a}(n,...t)]}},5016:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(2821),s=a(5889);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},9977:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(5155),s=a(2115),n=a(3209),l=a(3414),i=a(814),d=a(1847);let o=(0,d.A)("ship",[["path",{d:"M12 10.189V14",key:"1p8cqu"}],["path",{d:"M12 2v3",key:"qbqxhf"}],["path",{d:"M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6",key:"qpkstq"}],["path",{d:"M19.38 20A11.6 11.6 0 0 0 21 14l-8.188-3.639a2 2 0 0 0-1.624 0L3 14a11.6 11.6 0 0 0 2.81 7.76",key:"7tigtc"}],["path",{d:"M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1s1.2 1 2.5 1c2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"1924j5"}]]),c=(0,d.A)("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);var u=a(2685);function m(){let{isReady:e,getGoals:t,getMilestonesByGoal:a,getTasksByMilestone:d}=(0,u.t)(),[m,p]=(0,s.useState)([]),[g,h]=(0,s.useState)({}),[x,f]=(0,s.useState)({}),[v,y]=(0,s.useState)(null);(0,s.useEffect)(()=>{e&&N()},[e]);let N=async()=>{let e=await t();for(let t of(p(e),e)){let e=await a(t.id);for(let a of(h(a=>({...a,[t.id]:e})),e)){let e=await d(a.id);f(t=>({...t,[a.id]:e}))}}e.length>0&&y(e[0].id)},w=e=>{let t=g[e]||[];if(0===t.length)return 0;let a=0,r=0;for(let e of t){let t=x[e.id]||[];a+=t.length,r+=t.filter(e=>"done"===e.status).length}return 0===a?0:Math.round(r/a*100)};if(!e)return(0,r.jsx)("div",{className:"container mx-auto p-4",children:"読み込み中..."});let S=m.find(e=>e.id===v),D=g[v||""]||[];return(0,r.jsxs)("div",{className:"container mx-auto p-4 max-w-7xl",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"航海タイムライン"}),(0,r.jsx)("p",{className:"text-muted-foreground mt-2",children:"目標までの道のりを俸瞰しましょう"})]}),0===m.length?(0,r.jsxs)(n.Zp,{className:"p-12 text-center",children:[(0,r.jsx)(i.A,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"まだ目標がありません"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"目標を設定して航海を始めましょう"})]}):(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)(n.Zp,{children:[(0,r.jsx)(n.aR,{children:(0,r.jsx)(n.ZB,{children:"目標一覧"})}),(0,r.jsx)(n.Wu,{className:"space-y-2",children:m.map(e=>{let t=w(e.id);return(0,r.jsxs)("button",{onClick:()=>y(e.id),className:"w-full text-left p-3 rounded-lg transition-colors ".concat(v===e.id?"bg-primary text-primary-foreground":"hover:bg-accent"),children:[(0,r.jsx)("div",{className:"font-medium",children:e.title}),(0,r.jsxs)("div",{className:"text-sm mt-1",children:["進捗: ",t,"%"]})]},e.id)})})]})}),(0,r.jsx)("div",{className:"lg:col-span-3",children:S&&(0,r.jsxs)(n.Zp,{className:"h-[600px]",children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(i.A,{className:"h-5 w-5"}),S.title]}),(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:["目標日: ",new Date(S.targetDate).toLocaleDateString("ja-JP")]})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsxs)("div",{className:"relative h-[500px]",children:[(0,r.jsx)("div",{className:"absolute left-0 right-0 top-1/2 -translate-y-1/2 h-2 bg-gradient-to-r from-blue-200 to-blue-500 rounded-full"}),(0,r.jsxs)("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2 z-10",style:{left:"10%"},children:[(0,r.jsx)("div",{className:"bg-white border-2 border-primary rounded-full p-3 shadow-lg",children:(0,r.jsx)(o,{className:"h-6 w-6 text-primary"})}),(0,r.jsx)("div",{className:"mt-2 text-xs text-center font-medium",children:"現在地"})]}),D.map((e,t)=>{let a=((e,t)=>{let a=new Date,r=new Date(t),s=new Date(e),n=r.getTime()-a.getTime();return Math.max(0,Math.min(100,(s.getTime()-a.getTime())/n*100))})(e.targetDate,S.targetDate),s=x[e.id]||[],n=s.filter(e=>"done"===e.status).length;return(0,r.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2",style:{left:"".concat(a,"%")},children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"bg-white border-2 ".concat(e.completed?"border-green-500":"border-gray-300"," rounded-full p-2 shadow-md"),children:(0,r.jsx)(c,{className:"h-5 w-5 ".concat(e.completed?"text-green-500":"text-gray-500")})}),(0,r.jsxs)("div",{className:"absolute top-full mt-2 w-32 text-center",children:[(0,r.jsx)("div",{className:"text-xs font-medium",children:e.title}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground mt-1",children:[n,"/",s.length," タスク"]}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:new Date(e.targetDate).toLocaleDateString("ja-JP",{month:"numeric",day:"numeric"})})]})]})},e.id)}),(0,r.jsxs)("div",{className:"absolute top-1/2 -translate-y-1/2 -translate-x-1/2",style:{left:"95%"},children:[(0,r.jsx)("div",{className:"bg-gradient-to-br from-yellow-400 to-yellow-600 border-2 border-yellow-700 rounded-full p-4 shadow-xl",children:(0,r.jsx)(i.A,{className:"h-8 w-8 text-white"})}),(0,r.jsx)("div",{className:"mt-2 text-sm text-center font-bold",children:"宝島"})]}),(0,r.jsxs)("div",{className:"absolute bottom-0 left-0 right-0",children:[(0,r.jsxs)("div",{className:"mb-2 text-sm font-medium",children:["全体進捗: ",w(v||""),"%"]}),(0,r.jsx)(l.k,{value:w(v||""),className:"h-3"})]})]})})]})})]})]})}}},e=>{e.O(0,[140,441,255,358],()=>e(e.s=3193)),_N_E=e.O()}]);