(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{235:(e,t,a)=>{"use strict";a.d(t,{J:()=>n});var r=a(5155);a(2115);var i=a(489),s=a(5016);function n(e){let{className:t,...a}=e;return(0,r.jsx)(i.b,{"data-slot":"label",className:(0,s.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},489:(e,t,a)=>{"use strict";a.d(t,{b:()=>l});var r=a(2115),i=a(7602),s=a(5155),n=r.forwardRef((e,t)=>(0,s.jsx)(i.sG.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null==(a=e.onMouseDown)||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var l=n},2685:(e,t,a)=>{"use strict";a.d(t,{t:()=>o});var r=a(2115);class i{getData(){let e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):{}}saveData(e){localStorage.setItem(this.storageKey,JSON.stringify(e))}async query(e,t){let a=this.getData()[e]||[];return t?a.filter(t):a}async insert(e,t){let a=this.getData();a[e]||(a[e]=[]);let r="".concat(e,"_").concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),i={...t,id:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return a[e].push(i),this.saveData(a),r}async update(e,t,a){let r=this.getData();if(!r[e])return;let i=r[e].findIndex(e=>e.id===t);-1!==i&&(r[e][i]={...r[e][i],...a,updatedAt:new Date().toISOString()},this.saveData(r))}async delete(e,t){let a=this.getData();a[e]&&(a[e]=a[e].filter(e=>e.id!==t),this.saveData(a))}constructor(){this.storageKey="voyage-data"}}let s=null;async function n(){return s||(s=new i)}async function l(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=await n(),a=e.match(/SELECT .* FROM ([a-zA-Z_]+)/i);if(a){let e=a[1];return t.query(e)}return[]}async function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=await n(),r=e.match(/INSERT INTO ([a-zA-Z_]+) \((.*?)\) VALUES/i);if(r){let e=r[1],i=r[2].split(",").map(e=>e.trim()),s={};return i.forEach((e,a)=>{s[e]=t[a]}),a.insert(e,s)}throw Error("Unsupported SQL operation")}function o(){let[e,t]=(0,r.useState)(!1),[a,i]=(0,r.useState)(null);(0,r.useEffect)(()=>{n().then(()=>t(!0)).catch(e=>i(e.message))},[]);let s=(0,r.useCallback)(async e=>{let t=crypto.randomUUID(),a=new Date().toISOString();return await d("INSERT INTO goals (id, title, description, target_date, vision, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?)",[t,e.title,e.description,e.targetDate.toISOString(),e.vision||null,a,a]),t},[]),o=(0,r.useCallback)(async()=>(await l("SELECT * FROM goals ORDER BY created_at DESC")).map(e=>({id:e.id,title:e.title,description:e.description,targetDate:new Date(e.target_date),vision:e.vision,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)})),[]),c=(0,r.useCallback)(async(e,t)=>{let a=[],r=[];void 0!==t.title&&(a.push("title = ?"),r.push(t.title)),void 0!==t.description&&(a.push("description = ?"),r.push(t.description)),void 0!==t.targetDate&&(a.push("target_date = ?"),r.push(t.targetDate.toISOString())),void 0!==t.vision&&(a.push("vision = ?"),r.push(t.vision)),a.push("updated_at = ?"),r.push(new Date().toISOString()),r.push(e),await l("UPDATE goals SET ".concat(a.join(", ")," WHERE id = ?"),r)},[]),u=(0,r.useCallback)(async e=>{await l("DELETE FROM goals WHERE id = ?",[e])},[]),p=(0,r.useCallback)(async e=>{let t=crypto.randomUUID(),a=new Date().toISOString();return await d("INSERT INTO milestones (id, goal_id, title, description, target_date, completed, order_num, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)",[t,e.goalId,e.title,e.description||null,e.targetDate.toISOString(),+!!e.completed,e.order,a,a]),t},[]),g=(0,r.useCallback)(async e=>(await l("SELECT * FROM milestones WHERE goal_id = ? ORDER BY order_num ASC",[e])).map(e=>({id:e.id,goalId:e.goal_id,title:e.title,description:e.description,targetDate:new Date(e.target_date),completed:1===e.completed,order:e.order_num,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)})),[]),h=(0,r.useCallback)(async e=>{var t,a;let r=crypto.randomUUID(),i=new Date().toISOString();return await d("INSERT INTO tasks (id, milestone_id, title, description, status, priority, due_date, completed_at, dependencies, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",[r,e.milestoneId,e.title,e.description||null,e.status,e.priority,(null==(t=e.dueDate)?void 0:t.toISOString())||null,(null==(a=e.completedAt)?void 0:a.toISOString())||null,e.dependencies?JSON.stringify(e.dependencies):null,i,i]),r},[]),v=(0,r.useCallback)(async e=>(await l("SELECT * FROM tasks WHERE milestone_id = ? ORDER BY priority DESC, created_at ASC",[e])).map(e=>({id:e.id,milestoneId:e.milestone_id,title:e.title,description:e.description,status:e.status,priority:e.priority,dueDate:e.due_date?new Date(e.due_date):void 0,completedAt:e.completed_at?new Date(e.completed_at):void 0,dependencies:e.dependencies?JSON.parse(e.dependencies):void 0,createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)})),[]),m=(0,r.useCallback)(async(e,t)=>{let a=new Date().toISOString(),r="done"===t?a:null;await l("UPDATE tasks SET status = ?, completed_at = ?, updated_at = ? WHERE id = ?",[t,r,a,e])},[]);return{isReady:e,error:a,createGoal:s,getGoals:o,updateGoal:c,deleteGoal:u,createMilestone:p,getMilestonesByGoal:g,createTask:h,getTasksByMilestone:v,updateTaskStatus:m,saveEmotionLog:(0,r.useCallback)(async e=>{crypto.randomUUID();let t=new Date().toISOString(),a=e.date.toISOString().split("T")[0];await l("INSERT OR REPLACE INTO emotion_logs (id, date, mood, energy, note, created_at) VALUES ((SELECT id FROM emotion_logs WHERE date = ?), ?, ?, ?, ?, ?)",[a,a,e.mood,e.energy,e.note||null,t])},[]),getEmotionLogs:(0,r.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return(await l("SELECT * FROM emotion_logs ORDER BY date DESC LIMIT ?",[e])).map(e=>({id:e.id,date:new Date(e.date),mood:e.mood,energy:e.energy,note:e.note,createdAt:new Date(e.created_at)}))},[])}}},3101:(e,t,a)=>{"use strict";a.d(t,{F:()=>n});var r=a(2821);let i=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=r.$,n=(e,t)=>a=>{var r;if((null==t?void 0:t.variants)==null)return s(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:n,defaultVariants:l}=t,d=Object.keys(n).map(e=>{let t=null==a?void 0:a[e],r=null==l?void 0:l[e];if(null===t)return null;let s=i(t)||i(r);return n[e][s]}),o=a&&Object.entries(a).reduce((e,t)=>{let[a,r]=t;return void 0===r||(e[a]=r),e},{});return s(e,d,null==t||null==(r=t.compoundVariants)?void 0:r.reduce((e,t)=>{let{class:a,className:r,...i}=t;return Object.entries(i).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...l,...o}[t]):({...l,...o})[t]===a})?[...e,a,r]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}},3209:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>l,Zp:()=>s,aR:()=>n});var r=a(5155);a(2115);var i=a(5016);function s(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,i.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,i.cn)("leading-none font-semibold",t),...a})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...a})}function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,i.cn)("px-6",t),...a})}},4919:(e,t,a)=>{Promise.resolve().then(a.bind(a,6880))},5016:(e,t,a)=>{"use strict";a.d(t,{cn:()=>s});var r=a(2821),i=a(5889);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,i.QP)((0,r.$)(t))}},6170:(e,t,a)=>{"use strict";a.d(t,{p:()=>s});var r=a(5155);a(2115);var i=a(5016);function s(e){let{className:t,type:a,...s}=e;return(0,r.jsx)("input",{type:a,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...s})}},6880:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(5155),i=a(2115),s=a(3209),n=a(7003),l=a(6170),d=a(235),o=a(1847);let c=(0,o.A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),u=(0,o.A)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),p=(0,o.A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),g=(0,o.A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),h=(0,o.A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),v=(0,o.A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),m=(0,o.A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var x=a(2685);let y=i.createContext(void 0);function f(){let{getGoals:e,getMilestonesByGoal:t,getTasksByMilestone:a,getEmotionLogs:s}=(0,x.t)(),{toast:l}=function(){let e=i.useContext(y);return e||{toast:()=>{},toasts:[],dismiss:()=>{}}}(),[d,o]=(0,i.useState)(!1),[c,u]=(0,i.useState)(!1),p=async()=>{o(!0);try{let r=await e(),i={version:"1.0",exportDate:new Date().toISOString(),goals:[],emotionLogs:await s(365)};for(let e of r){let r=await t(e.id),s={...e,milestones:[]};for(let e of r){let t=await a(e.id);s.milestones.push({...e,tasks:t})}i.goals.push(s)}let n=new Blob([JSON.stringify(i,null,2)],{type:"application/json"}),d=URL.createObjectURL(n),o=document.createElement("a");o.href=d,o.download="voyage-backup-".concat(new Date().toISOString().split("T")[0],".json"),o.click(),URL.revokeObjectURL(d),l({title:"✅ エクスポート完了",description:"データをダウンロードしました"})}catch(e){l({title:"❌ エクスポート失敗",description:"データの取得に失敗しました",variant:"destructive"})}finally{o(!1)}};return(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)(n.$,{onClick:p,disabled:d,children:[(0,r.jsx)(v,{className:"mr-2 h-4 w-4"}),d?"エクスポート中...":"データエクスポート"]}),(0,r.jsxs)(n.$,{onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="application/json",e.onchange=async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a){u(!0);try{let e=await a.text(),t=JSON.parse(e);if("1.0"!==t.version)throw Error("互換性のないバージョンです");l({title:"⚠️ インポート機能",description:"インポート処理は次回実装予定です"})}catch(e){l({title:"❌ インポート失敗",description:"ファイルの読み込みに失敗しました",variant:"destructive"})}finally{u(!1)}}},e.click()},disabled:c,variant:"outline",children:[(0,r.jsx)(m,{className:"mr-2 h-4 w-4"}),c?"インポート中...":"データインポート"]})]})}function b(){let[e,t]=(0,i.useState)(""),[a,o]=(0,i.useState)(!1),[v,m]=(0,i.useState)("gpt-5"),[x,y]=(0,i.useState)(0),[b,w]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=localStorage.getItem("openai_api_key")||"",a=localStorage.getItem("ai_model")||"gpt-5",r=localStorage.getItem("weekly_review_day")||"0";t(e),m(a),y(parseInt(r))},[]),(0,r.jsxs)("div",{className:"container mx-auto p-4 max-w-3xl",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[(0,r.jsx)(c,{className:"h-8 w-8"}),"設定"]}),(0,r.jsx)("p",{className:"text-muted-foreground mt-2",children:"アプリケーションの設定を管理します"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(s.Zp,{children:[(0,r.jsxs)(s.aR,{children:[(0,r.jsxs)(s.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(u,{className:"h-5 w-5"}),"OpenAI API設定"]}),(0,r.jsx)(s.BT,{children:"AI機能を使用するためのAPIキーを設定します"})]}),(0,r.jsxs)(s.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(d.J,{htmlFor:"apiKey",children:"APIキー"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(l.p,{id:"apiKey",type:a?"text":"password",value:e,onChange:e=>t(e.target.value),placeholder:"sk-..."}),(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:()=>o(!a),children:a?(0,r.jsx)(p,{className:"h-4 w-4"}):(0,r.jsx)(g,{className:"h-4 w-4"})})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"APIキーはブラウザのローカルストレージに保存され、外部には送信されません"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(d.J,{htmlFor:"model",children:"AIモデル"}),(0,r.jsxs)("select",{id:"model",value:v,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border rounded-md",children:[(0,r.jsx)("option",{value:"gpt-5",children:"GPT-5 (最新)"}),(0,r.jsx)("option",{value:"gpt-4",children:"GPT-4 (高精度)"}),(0,r.jsx)("option",{value:"gpt-4-turbo",children:"GPT-4 Turbo (高速)"}),(0,r.jsx)("option",{value:"gpt-3.5-turbo",children:"GPT-3.5 Turbo (経済的)"})]})]})]})]}),(0,r.jsxs)(s.Zp,{children:[(0,r.jsxs)(s.aR,{children:[(0,r.jsx)(s.ZB,{children:"週次レビュー設定"}),(0,r.jsx)(s.BT,{children:"振り返りを行う曜日を設定します"})]}),(0,r.jsx)(s.Wu,{children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(d.J,{htmlFor:"reviewDay",children:"レビュー曜日"}),(0,r.jsx)("select",{id:"reviewDay",value:x,onChange:e=>y(parseInt(e.target.value)),className:"w-full px-3 py-2 border rounded-md",children:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"].map((e,t)=>(0,r.jsx)("option",{value:t,children:e},t))})]})})]}),(0,r.jsxs)(s.Zp,{children:[(0,r.jsxs)(s.aR,{children:[(0,r.jsx)(s.ZB,{children:"\uD83D\uDDC2️ データ管理"}),(0,r.jsx)(s.BT,{children:"データのバックアップとリストア"})]}),(0,r.jsx)(s.Wu,{children:(0,r.jsx)(f,{})})]}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsxs)(n.$,{onClick:()=>{localStorage.setItem("openai_api_key",e),localStorage.setItem("ai_model",v),localStorage.setItem("weekly_review_day",x.toString()),w(!0),setTimeout(()=>w(!1),3e3)},size:"lg",children:[(0,r.jsx)(h,{className:"h-4 w-4 mr-2"}),"設定を保存"]})}),b&&(0,r.jsx)("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg",children:"設定を保存しました"})]})]})}},7003:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var r=a(5155);a(2115);var i=a(2467),s=a(3101),n=a(5016);let l=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:t,variant:a,size:s,asChild:d=!1,...o}=e,c=d?i.DX:"button";return(0,r.jsx)(c,{"data-slot":"button",className:(0,n.cn)(l({variant:a,size:s,className:t})),...o})}}},e=>{e.O(0,[140,441,255,358],()=>e(e.s=4919)),_N_E=e.O()}]);